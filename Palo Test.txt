set deviceconfig system permitted-ip 172.20.242.0/24 ---- UbuntuWkst IP 
set deviceconfig system login-banner AuthorizedAccessOnly


set network profiles interface-management-profile Default ping no https yes ssh yes telnet no http no snmp no response-pages no
set network profiles interface-management-profile Default permitted-ip 172.20.242.0/24


set network interface ethernet ethernet1/1 layer3 interface-management-profile Default
set network interface ethernet ethernet1/2 layer3 interface-management-profile Default




set profile-group SecPro file-blocking "strict file blocking" spyware default url-filtering default virus default vulnerability default wildfire-analysis default


set network profiles zone-protection-profile ZonePro discard-tcp-synack-with-data yes
set network profiles zone-protection-profile ZonePro discard-timestamp yes
set network profiles zone-protection-profile ZonePro discard-unknown-option yes
set network profiles zone-protection-profile ZonePro remove-tcp-timestamp yes
set network profiles zone-protection-profile ZonePro strict-ip-check yes
set network profiles zone-protection-profile ZonePro strip-mptcp-option yes
set network profiles zone-protection-profile ZonePro strip-tcp-fast-open-and-data yes
set network profiles zone-protection-profile ZonePro suppress-icmp-needfrag yes
set network profiles zone-protection-profile ZonePro suppress-icmp-timeexceeded yes
set network profiles zone-protection-profile ZonePro tcp-reject-non-syn yes

set network profiles zone-protection-profile ZonePro flood tcp-syn enable yes red activate-rate 10000 alarm-rate 10000 maximal-rate 10000
set network profiles zone-protection-profile ZonePro flood udp enable yes red activate-rate 10000 alarm-rate 10000 maximal-rate 10000
set network profiles zone-protection-profile ZonePro flood icmp enable yes red activate-rate 10000 alarm-rate 10000 maximal-rate 10000
set network profiles zone-protection-profile ZonePro flood other-ip enable yes red activate-rate 10000 alarm-rate 10000 maximal-rate 10000
set network profiles zone-protection-profile ZonePro flood icmpv6 enable yes red alarm-rate 1000 activate-rate 2000 maximal-rate 3000




set zone external network zone-protection-profile ZonePro
set zone internal network zone-protection-profile ZonePro




set service Splunk-1514-tcp protocol tcp port 1514
set service Splunk-1514-udp protocol udp port 1514
set service-group Splunk-1514-both members [ Splunk-1514-tcp Splunk-1514-udp ]
set service Splunk-9998 protocol tcp port 9998





set address ecom ip-netmask 172.20.242.30/32
set address splunk ip-netmask 172.20.242.20/32
set address webmail ip-netmask 172.20.242.40/32

set address ecom-public ip-netmask 172.25.29.11/32
set address webmail-public ip-netmask 172.25.29.39/32
set address splunk-public ip-netmask 172.25.29.9/32

set address linux-inside ip-netmask 172.20.242.0/24
set address Public IPs ip-netmask 172.25.29.0/24

set address cisco-net-240 ip-netmask 172.20.240.0/24
set address UbuntuWkst-Admin ip-netmask 172.20.242.11
set address palo-mgmt ip-netmask 172.20.242.150/32


set address-group public-servers static [ ecom-public splunk-public webmail-public ]
set address-group internal-servers static [ ecom splunk webmail ]




set rulebase security rules Allow-ICMP-Inbound profile-setting group SecPro
set rulebase security rules Allow-ICMP-Inbound from external to internal source any destination any application ping service application-default action allow log-start yes log-end yes


set rulebase security rules Allow-Ecom-Inbound profile-setting group SecPro
set rulebase security rules Allow-Ecom-Inbound from external to internal source any destination ecom application [ ssl web-browsing ] service application-default action allow log-start yes log-end yes


set rulebase security rules Allow-Webmail-Inbound profile-setting group SecPro
set rulebase security rules Allow-Webmail-Inbound from external to internal source any destination webmail application [ ssl web-browsing smtp pop3 imap ] service application-default action allow log-start yes log-end yes


set rulebase security rules Allow-Splunk-Inbound profile-setting group SecPro
set rulebase security rules Allow-Splunk-Inbound from external to internal source any destination splunk application [ splunk ssl web-browsing ] service application-default action allow log-start yes log-end yes


set rulebase security rules Inbound-Deny-All from external to internal source any destination any application any service any action deny log-start yes log-end yes



set rulebase security rules Allow-Splunk-Ingest profile-setting group SecPro
set rulebase security rules Allow-Splunk-Ingest from internal to internal source [ webmail ecom palo-mgmt ] destination splunk application any service [ Splunk-1514-both Splunk-9998 ] action allow log-start yes log-end yes


set rulebase security rules Deny-Server-Lateral from internal to internal source linux-inside destination linux-inside application any service any action deny log-start yes log-end yes

set rulebase security rules Allow-DNS-Outbound profile-setting group SecPro
set rulebase security rules Allow-DNS-Outbound from internal to external source linux-inside destination any application dns service application-default action allow log-start yes log-end yes


set rulebase security rules Allow-Core-Web-Outbound profile-setting group SecPro
set rulebase security rules Allow-Core-Web-Outbound from internal to external source linux-inside destination any application [ ssl web-browsing ] service application-default action allow log-start yes log-end yes


set rulebase security rules Allow-NTP-Outbound profile-setting group SecPro
set rulebase security rules Allow-NTP-Outbound from internal to external source linux-inside destination any application ntp service application-default action allow log-start yes log-end yes


set rulebase security rules Allow-Webmail-Outbound profile-setting group SecPro
set rulebase security rules Allow-Webmail-Outbound from internal to external source webmail destination any application [ ssl web-browsing smtp pop3 imap ] service application-default action allow log-start yes log-end yes


set rulebase security rules Allow-Palo-Updates profile-setting group SecPro
set rulebase security rules Allow-Palo-Updates from internal to external source palo-mgmt destination any application [ pan-db-cloud paloalto-updates paloalto-wildfire-cloud ] service application-default action allow log-start yes log-end yes


set rulebase security rules Allow-Linux-Repos profile-setting group SecPro
set rulebase security rules Allow-Linux-Repos from internal to external source linux-inside destination any application [ github apt-get google-base yum ] service application-default action allow log-start yes log-end yes


set rulebase security rules Outbound-Deny-All from internal to external source any destination any application any service any action deny log-start yes log-end yes


set rulebase security rules BlockBad from any to any source any destination any application [ telnet ms-rdp vnc ftp tftp snmp ms-ds-smb rpc http-proxy ] service application-default action deny log-start yes log-end yes


set rulebase security rules Deny-All from any to any source any destination any application any service any action deny log-start yes log-end yes


request anti-virus upgrade install version latest
request wildfire upgrade install version latest
request content upgrade install version latest


